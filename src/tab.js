export const textarea = document.querySelector('#tab-editor');

textarea.addEventListener('paste', (e) => {
  e.preventDefault();
  const data = e.clipboardData.getData('text/plain');
  textarea.innerHTML = data;
});

textarea.innerHTML = `
    Gtr I
   E E E E E E E E   E E E E E E E E   E E E E E E E E   E E E E E E E E
  e|-0---0---0---0---|-----------------|-----------------|-------------------|
  B|---0---0---0---0-|-3---3---3---3---|-3---3---3---3---|-3---3---3---3----o|
  G|-----0-------0---|---4---4---4---4-|---4---4---4---4-|---2---2---2---2---|
  D|-----------------|-----5-------5---|-----4-------4---|-0---4---0---4-----|
  A|-7-------7-------|-5-------5-------|-5-------5-------|------------------o|
  E|-----------------|-----------------|-----------------|-------------------|
   
   
       E S S E S S E E E E   E S S E S S E E E E
  e|----3p2-3-7h8-7-------|---2h3-2-3h5-3-------|
  B|o---0-----0-----0---0-|---0-----0-----0---0-|
  G|--------0---------0---|-------0---------0---|
  D|--2-------------------|-0-----------0-------|
  A|o-------------7-------|---------------------|
  E|----------------------|---------------------|
   
   
     E S S E S S E E E E   E S S E E E E E E
  e|---2p0-2-7h8-7-------|---2p0-2-------------|
  B|---0-----0-----0---0-|--------------------o|
  G|---------------------|---2-----2---2---2---|
  D|-0-----4-----0-------|-0-----4---0---4-----|
  A|-----------------9---|--------------------o|
  E|---------------------|---------------------|
   
   
      E E E E E E E E    E E E E E E E E
  e|-12-----7---------|-10-----7---------|
  B|----0---0---0---0-|----0---0---0---0-|
  G|------0-------0---|------0-------0---|
  D|------------------|--0-------0-------|
  A|--7-------7-------|------------------|
  E|------------------|------------------|
   
   
      E E E E E E E E    E  E  E  E E  E  E  E
  e|-14-----7---------|-14---------------------|
  B|----0---0---0---0-|------------------------|
  G|------------------|----------14------------|
  D|--0-------0---4---|--0----------0----------|
  A|------9-----------|----12----12---12----12-|
  E|------------------|-------14---------14----|
   
   
     E E E E E E E E   E E E E E E E E   E E E E E E E E   E E E E E E E E
  e|-------0---------|-3---------------|-2---------------|-2---------------|
  B|-8-0---0---0---0-|-3-0---3---------|-3-0---3---------|-3-----3---------|
  G|-9---0-------0---|-----0-4---4---4-|-------4---4---4-|---2---2---2---2-|
  D|-----------------|-0-------0---5---|-0---4-------4---|-0---4---0---4---|
  A|-7-------7-------|-----------------|---------5-------|-----------------|
  E|-----------------|-----------------|-----------------|-----------------|
   
   
       S S S S S S S S S S S S S S S S   S S S S S S S S S S S S S S S S
  e|------7-----7-----7-----7-----8---|-----7-----7-----7-----7-----5----|
  B|o---0-----0-----0-----0-----0---0-|---0-----0-----0-----0-----0---0--|
  G|--------0-----------0-------------|-------0-----------0--------------|
  D|----------------------------------|-0-----------0-----------0--------|
  A|o-7-----------7-----------7-------|----------------------------------|
  E|----------------------------------|----------------------------------|
   
   
     S S S S S S S S S S S S S S S S   S S S S S S S S S S S S S S S S
  e|-----2-----2-----2-----2-----3---|-----5-----5-----5-----5-----3------|
  B|---0-----0-----0-----0-----0---0-|---3-----3-----3-----3-----3---3---o|
  G|-------4-----------4-------------|-------2-----------2----------------|
  D|-0-----------0-----------0-------|-0-----------0-----------0----------|
  A|---------------------------------|-----------------------------------o|
  E|---------------------------------|------------------------------------|
   
   
     W
  e|-0----*|
  B|------*|
  G|------*|
  D|------*|
  A|------*|
  E|-0----*|
`.trim();

export const tabNumToHz = (tabNum, stringNum) => {
    let stringPitch;
    switch(stringNum) {
      case 0:
        stringPitch = -5;
      case 1:
        stringPitch = -10;
        break;
      case 2:
        stringPitch = -14;
        break;
      case 3:
        stringPitch = -19;
        break;
      case 4:
        stringPitch = -24;
        break;
      case 5:
        stringPitch = -29;
        break;
    }

  const pitch = stringPitch + tabNum;
  const hz = 440.0 * Math.pow(2, pitch / 12.0);
  return hz;
};

const parseTab = () => {
  textarea.innerHTML = textarea.innerHTML.replace(/[-][|][-]/g, '-');
  const tabText = textarea.innerHTML;
  console.log(tabText);

  let isPartOfTab = true;

  const lines = tabText.match(/[|-].+[-]+.+/g);
  const blocks = [];
  let guitar = [];
  let blockNum = -1;
  lines.forEach((l, i) => {
    let stringNum = i % 6;
    if (stringNum === 0) {
      blockNum++;
      blocks[blockNum] = [];
    }
    const guitar = blocks[blockNum];
    guitar[stringNum] = l;
  });

  return blocks;
}

export { parseTab };
